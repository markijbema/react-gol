<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv='Content-type' content='text/html; charset=utf-8'>
    <title>Conways Game of Life</title>
    <style>
      .cell {width: 10px;height: 10px;}
      .alive {background-color: green;}
      .dead {background-color: red;}
    </style>
  </head>
  <body>
    <div id="container"></div>
    <script src="http://fb.me/react-0.8.0.js"></script>
    <script src="http://fb.me/JSXTransformer-0.8.0.js"></script>
    <script type="text/jsx">
      /**
       * @jsx React.DOM
       */
      var Grid = React.createClass({
        render: function() {
          var list_of_rows = this.props.grid.map(function(row, y){
            return <tr key={y}><td className="alive cell" /></tr>
          })

          return <table>{list_of_rows}</table>;
        }
      });

      var GoL = React.createClass({
         getInitialState: function(){
           return {grid: this.props.startingGrid};
         },

         componentWillReceiveProps: function(nextProps) {
           this.setState({grid: nextProps.startingGrid});
         },

         render: function(){
          return <div>
                   <Grid grid={this.state.grid}/>
                 </div>
        }
      })
   

      large = [0,0,0,0,0,0];
      small = [0,0,0,0];

      Game = React.createClass({
        getInitialState: function(){
          return { grid: small }
        },
        chooseSmall: function(){
          console.info("Chose small")
          this.setState({grid: small});
        },
        chooseLarge: function(){
          console.info("Chose large")
          this.setState({grid: large})
        },
        render: function(){
          return <div>
                  <ul>
                    <li><a href="javascript:" onClick={this.chooseSmall}>small</a></li>
                    <li><a href="javascript:" onClick={this.chooseLarge}>large</a></li>
                  </ul>
                  <GoL startingGrid={this.state.grid}/>
                 </div>
        }
      });

      React.renderComponent(
        <Game />,
        document.getElementById('container')
      );
    </script>
  </body>
</html>
